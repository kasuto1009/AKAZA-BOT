{
  "manifest": {
    "name": "@cacheable/utils",
    "version": "2.1.0",
    "description": "Cacheable Utilities for Caching Libraries",
    "type": "module",
    "main": "./dist/index.cjs",
    "module": "./dist/index.js",
    "types": "./dist/index.d.ts",
    "exports": {
      ".": {
        "require": "./dist/index.cjs",
        "import": "./dist/index.js"
      }
    },
    "repository": {
      "type": "git",
      "url": "git+https://github.com/jaredwray/cacheable.git",
      "directory": "packages/utils"
    },
    "author": {
      "name": "Jared Wray",
      "email": "me@jaredwray.com"
    },
    "license": "MIT",
    "private": false,
    "devDependencies": {
      "@biomejs/biome": "^2.2.4",
      "@faker-js/faker": "^10.0.0",
      "@keyv/redis": "^5.1.2",
      "@keyv/valkey": "^1.0.8",
      "@types/node": "^24.5.2",
      "@vitest/coverage-v8": "^3.2.4",
      "lru-cache": "^11.2.2",
      "rimraf": "^6.0.1",
      "tsup": "^8.5.0",
      "typescript": "^5.9.2",
      "vitest": "^3.2.4"
    },
    "keywords": [
      "cacheable",
      "caching",
      "utilities",
      "hashing",
      "keyv",
      "cache utils"
    ],
    "files": [
      "dist",
      "LICENSE"
    ],
    "dependencies": {
      "keyv": "^5.5.3"
    },
    "scripts": {
      "build": "rimraf ./dist && tsup src/index.ts --format cjs,esm --dts --clean --minify",
      "prepublish": "pnpm build",
      "lint": "biome check --write --error-on-warnings",
      "test": "pnpm lint && vitest run --coverage",
      "test:ci": "biome check --error-on-warnings && vitest run --coverage",
      "clean": "rimraf ./dist ./coverage ./node_modules"
    },
    "_registry": "npm",
    "_loc": "/home/container/.cache/yarn/v6/npm-@cacheable-utils-2.1.0-fbef92c5bfe720eadbdbf516c5fa64dee794d35d-integrity/node_modules/@cacheable/utils/package.json",
    "readmeFilename": "README.md",
    "readme": "[<img align=\"center\" src=\"https://cacheable.org/logo.svg\" alt=\"Cacheable\" />](https://github.com/jaredwray/cacheable)\n\n> Cacheble Utils\n\n[![codecov](https://codecov.io/gh/jaredwray/cacheable/graph/badge.svg?token=lWZ9OBQ7GM)](https://codecov.io/gh/jaredwray/cacheable)\n[![tests](https://github.com/jaredwray/cacheable/actions/workflows/tests.yml/badge.svg)](https://github.com/jaredwray/cacheable/actions/workflows/tests.yml)\n[![npm](https://img.shields.io/npm/dm/@cacheable/utils.svg)](https://www.npmjs.com/package/@cacheable/utils)\n[![npm](https://img.shields.io/npm/v/@cacheable/utils)](https://www.npmjs.com/package/@cacheable/utils)\n[![license](https://img.shields.io/github/license/jaredwray/cacheable)](https://github.com/jaredwray/cacheable/blob/main/LICENSE)\n\n`@cacheable/utils` is a collecton of utility functions, helpers, and types for `cacheable` and other caching libraries. It provides a robust set of features to enhance caching capabilities, including:\n\n* Data Types for Caching Items\n* Hash Functions for Key Generation\n* Coalesce Async for Handling Multiple Promises\n* Stats Helpers for Caching Statistics\n* Sleep / Delay for Testing and Timing\n* Time to Live (TTL) Helpers\n\n# Table of Contents\n* [Getting Started](#getting-started)\n* [Cacheable Types](#cacheable-types)\n* [Coalesce Async](#coalesce-async)\n* [Hash Functions](#hash-functions)\n* [Shorthand Time Helpers](#shorthand-time-helpers)\n* [Sleep Helper](#sleep-helper)\n* [Stats Helpers](#stats-helpers)\n* [Time to Live (TTL) Helpers](#time-to-live-ttl-helpers)\n* [Run if Function Helper](#run-if-function-helper)\n* [Less Than Helper](#less-than-helper)\n* [Is Object Helper](#is-object-helper)\n* [How to Contribute](#how-to-contribute)\n* [License and Copyright](#license-and-copyright)\n\n# Getting Started\n\n`cacheable` is primarily used as an extension to your caching engine with a robust storage backend [Keyv](https://keyv.org), Memoization (Wrap), Hooks, Events, and Statistics.\n\n```bash\nnpm install @cacheable/utils --save\n```\n\n# Cacheable Types\n\nThe `@cacheable/utils` package provides various types that are used throughout the caching library. These types help in defining the structure of cached items, ensuring type safety and consistency across your caching operations.\n\n```typescript\n\n/**\n * CacheableItem\n * @typedef {Object} CacheableItem\n * @property {string} key - The key of the cacheable item\n * @property {any} value - The value of the cacheable item\n * @property {number|string} [ttl] - Time to Live - If you set a number it is miliseconds, if you set a string it is a human-readable\n * format such as `1s` for 1 second or `1h` for 1 hour. Setting undefined means that it will use the default time-to-live. If both are\n * undefined then it will not have a time-to-live.\n */\nexport type CacheableItem = {\n\tkey: string;\n\tvalue: any;\n\tttl?: number | string;\n};\n\n/**\n * CacheableStoreItem\n * @typedef {Object} CacheableStoreItem\n * @property {string} key - The key of the cacheable store item\n * @property {any} value - The value of the cacheable store item\n * @property {number} [expires] - The expiration time in milliseconds since epoch. If not set, the item does not expire.\n */\nexport type CacheableStoreItem = {\n\tkey: string;\n\tvalue: any;\n\texpires?: number;\n};\n```\n\n# Coalesce Async\n\nThe `coalesceAsync` function is a utility that allows you to handle multiple asynchronous operations efficiently. It was designed by `Douglas Cayers` https://github.com/douglascayers/promise-coalesce. It helps in coalescing multiple promises into a single promise, ensuring that only one operation is executed at a time for the same key.\n\n```typescript\nimport { coalesceAsync } from '@cacheable/utils';\n\nconst fetchData = async (key: string) => {\n  // Simulate an asynchronous operation\n  return new Promise((resolve) => setTimeout(() => resolve(`Data for ${key}`), 1000));\n};\n\nconst result = await Promise.all([\n\tcoalesceAsync('my-key', fetchData),\n\tcoalesceAsync('my-key', fetchData),\n\tcoalesceAsync('my-key', fetchData),\n]);\nconsole.log(result); // Data for my-key only executed once\n```\n\n# Hash Functions\n\nThe `@cacheable/utils` package provides hash functions that can be used to generate unique keys for caching operations. These functions are useful for creating consistent and unique identifiers for cached items.\n\n```typescript\nimport { hash } from '@cacheable/utils';\n\nconst key = hash('my-cache-key');\nconsole.log(key); // Unique hash for 'my-cache-key'\n```\n\nIf you want to get a number hash you can use the `hashToNumber` function:\n\n```typescript\nimport { hash, hashToNumber } from '@cacheable/utils';\n\nconst min = 0;\nconst max = 10;\n\nconst result = hashToNumber({foo: 'bar'}, min, max, HashAlgorithm.DJB2);\nconsole.log(result); // A number between 0 and 10 based on the hash value\n```\n\n# Shorthand Time Helpers\n\nThe `@cacheable/utils` package provides a shorthand function to convert human-readable time strings into milliseconds. This is useful for setting time-to-live (TTL) values in caching operations.\n\nYou can also use the `shorthandToMilliseconds` function:\n\n```typescript\nimport { shorthandToMilliseconds } from '@cacheable/utils';\n\nconst milliseconds = shorthandToMilliseconds('1h');\nconsole.log(milliseconds); // 3600000\n```\n\nYou can also use the `shorthandToTime` function to get the current date plus the shorthand time:\n\n```typescript\nimport { shorthandToTime } from '@cacheable/utils';\n\nconst currentDate = new Date();\nconst timeInMs = shorthandToTime('1h', currentDate);\nconsole.log(timeInMs); // Current date + 1 hour in milliseconds since epoch\n```\n\n# Sleep Helper\n\nThe `sleep` function is a utility that allows you to pause execution for a specified duration. This can be useful in testing scenarios or when you need to introduce delays in your code.\n\n```typescript\nimport { sleep } from '@cacheable/utils';\n\nawait sleep(1000); // Pause for 1 second\nconsole.log('Execution resumed after 1 second');\n```\n\n# Stats Helpers\n\nThe `@cacheable/utils` package provides statistics helpers that can be used to track and analyze caching operations. These helpers can be used to gather metrics such as hit rates, miss rates, and other performance-related statistics.\n\n```typescript\nimport { stats } from '@cacheable/utils';\n\nconst cacheStats = stats();\ncacheStats.incrementHits();\nconsole.log(cacheStats.hits); // Get the hit rate of the cache\n```\n\n# Time to Live (TTL) Helpers\n\nThe `@cacheable/utils` package provides helpers for managing time-to-live (TTL) values for cached items. \n\nYou can use the `calculateTtlFromExpiration` function to calculate the TTL based on an expiration date:\n\n```typescript\nimport { calculateTtlFromExpiration } from '@cacheable/utils';\n\nconst expirationDate = new Date(Date.now() + 1000 * 60 * 5); // 5 minutes from now\nconst ttl = calculateTtlFromExpiration(Date.now(), expirationDate);\nconsole.log(ttl); // 300000\n```\n\nYou can also use `getTtlFromExpires` to get the TTL from an expiration date:\n\n```typescript\nimport { getTtlFromExpires } from '@cacheable/utils';\n\nconst expirationDate = new Date(Date.now() + 1000 * 60 * 5); // 5 minutes from now\nconst ttl = getTtlFromExpires(expirationDate);\nconsole.log(ttl); // 300000\n```\n\nYou can use `getCascadingTtl` to get the TTL for cascading cache operations:\n\n```typescript\nimport { getCascadingTtl } from '@cacheable/utils';\nconst cacheableTtl = 1000 * 60 * 5; // 5 minutes\nconst primaryTtl = 1000 * 60 * 2; // 2 minutes\nconst secondaryTtl = 1000 * 60; // 1 minute\nconst ttl = getCascadingTtl(cacheableTtl, primaryTtl, secondaryTtl);\n```\n\n# Run if Function Helper\n\nThe `runIfFn` utility function provides a convenient way to conditionally execute functions or return values based on whether the input is a function or not. This pattern is commonly used in UI libraries and configuration systems where values can be either static or computed.\n\n```typescript\nimport { runIfFn } from '@cacheable/utils';\n\n// Static value - returns the value as-is\nconst staticValue = runIfFn('hello world');\nconsole.log(staticValue); // 'hello world'\n\n// Function with no arguments - executes the function\nconst dynamicValue = runIfFn(() => new Date().toISOString());\nconsole.log(dynamicValue); // Current timestamp\n\n// Function with arguments - executes with provided arguments\nconst sum = runIfFn((a: number, b: number) => a + b, 5, 10);\nconsole.log(sum); // 15\n\n// Complex example with conditional logic\nconst getConfig = (isDevelopment: boolean) => ({\n  apiUrl: isDevelopment ? 'http://localhost:3000' : 'https://api.example.com',\n  timeout: isDevelopment ? 5000 : 30000\n});\n\nconst config = runIfFn(getConfig, true);\nconsole.log(config); // { apiUrl: 'http://localhost:3000', timeout: 5000 }\n```\n\n# Less Than Helper\n\nThe `lessThan` utility function provides a safe way to compare two values and determine if the first value is less than the second. It only performs the comparison if both values are valid numbers, returning `false` for any non-number inputs.\n\n```typescript\nimport { lessThan } from '@cacheable/utils';\n\n// Basic number comparisons\nconsole.log(lessThan(1, 2)); // true\nconsole.log(lessThan(2, 1)); // false\nconsole.log(lessThan(1, 1)); // false\n\n// Works with negative numbers\nconsole.log(lessThan(-1, 0)); // true\nconsole.log(lessThan(-2, -1)); // true\n\n// Works with decimal numbers\nconsole.log(lessThan(1.5, 2.5)); // true\nconsole.log(lessThan(2.7, 2.7)); // false\n\n// Safe handling of non-number values\nconsole.log(lessThan(\"1\", 2)); // false\nconsole.log(lessThan(1, \"2\")); // false\nconsole.log(lessThan(null, 1)); // false\nconsole.log(lessThan(undefined, 1)); // false\nconsole.log(lessThan(NaN, 1)); // false\n\n// Useful in filtering and sorting operations\nconst numbers = [5, 2, 8, 1, 9];\nconst lessThanFive = numbers.filter(n => lessThan(n, 5));\nconsole.log(lessThanFive); // [2, 1]\n\n// Safe comparison in conditional logic\nfunction processValue(a?: number, b?: number) {\n  if (lessThan(a, b)) {\n    return `${a} is less than ${b}`;\n  }\n  return 'Invalid comparison or a >= b';\n}\n```\n\nThis utility is particularly useful when dealing with potentially undefined or invalid numeric values, ensuring type safety in comparison operations.\n\n# Is Object Helper\n\nThe `isObject` utility function provides a type-safe way to determine if a value is a plain object. It returns `true` for objects but `false` for arrays, `null`, functions, and primitive types. This function also serves as a TypeScript type guard.\n\n```typescript\nimport { isObject } from '@cacheable/utils';\n\n// Basic object detection\nconsole.log(isObject({})); // true\nconsole.log(isObject({ name: 'John', age: 30 })); // true\nconsole.log(isObject(Object.create(null))); // true\n\n// Arrays are not considered objects\nconsole.log(isObject([])); // false\nconsole.log(isObject([1, 2, 3])); // false\n\n// null is not considered an object (despite typeof null === 'object')\nconsole.log(isObject(null)); // false\n\n// Primitive types return false\nconsole.log(isObject('string')); // false\nconsole.log(isObject(123)); // false\nconsole.log(isObject(true)); // false\nconsole.log(isObject(undefined)); // false\n\n// Functions return false\nconsole.log(isObject(() => {})); // false\nconsole.log(isObject(Date)); // false\n\n// Built-in object types return true\nconsole.log(isObject(new Date())); // true\nconsole.log(isObject(/regex/)); // true\nconsole.log(isObject(new Error('test'))); // true\nconsole.log(isObject(new Map())); // true\n\n// TypeScript type guard usage\nfunction processValue(value: unknown) {\n  if (isObject<{ name: string; age: number }>(value)) {\n    // TypeScript now knows value is an object with name and age properties\n    console.log(`Name: ${value.name}, Age: ${value.age}`);\n  }\n}\n\n// Useful for configuration validation\nfunction validateConfig(config: unknown) {\n  if (!isObject(config)) {\n    throw new Error('Configuration must be an object');\n  }\n  \n  // Safe to access object properties\n  return config;\n}\n\n// Filtering arrays for objects only\nconst mixedArray = [1, 'string', {}, [], null, { valid: true }];\nconst objectsOnly = mixedArray.filter(isObject);\nconsole.log(objectsOnly); // [{}', { valid: true }]\n```\n\nThis utility is particularly useful for:\n- **Type validation** - Ensuring values are objects before accessing properties\n- **TypeScript type guarding** - Narrowing types in conditional blocks\n- **Configuration parsing** - Validating that configuration values are objects\n- **Data filtering** - Separating objects from other data types\n\n# How to Contribute\n\nYou can contribute by forking the repo and submitting a pull request. Please make sure to add tests and update the documentation. To learn more about how to contribute go to our main README [https://github.com/jaredwray/cacheable](https://github.com/jaredwray/cacheable). This will talk about how to `Open a Pull Request`, `Ask a Question`, or `Post an Issue`.\n\n# License and Copyright\n[MIT © Jared Wray](./LICENSE)\n",
    "licenseText": "MIT License & © Jared Wray \n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to\ndeal in the Software without restriction, including without limitation the\nrights to use, copy, modify, merge, publish, distribute, sublicense, and/or\nsell copies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\nDEALINGS IN THE SOFTWARE.\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/@cacheable/utils/-/utils-2.1.0.tgz#fbef92c5bfe720eadbdbf516c5fa64dee794d35d",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/@cacheable/utils/-/utils-2.1.0.tgz",
    "hash": "fbef92c5bfe720eadbdbf516c5fa64dee794d35d",
    "integrity": "sha512-ZdxfOiaarMqMj+H7qwlt5EBKWaeGihSYVHdQv5lUsbn8MJJOTW82OIwirQ39U5tMZkNvy3bQE+ryzC+xTAb9/g==",
    "registry": "npm",
    "packageName": "@cacheable/utils",
    "cacheIntegrity": "sha512-ZdxfOiaarMqMj+H7qwlt5EBKWaeGihSYVHdQv5lUsbn8MJJOTW82OIwirQ39U5tMZkNvy3bQE+ryzC+xTAb9/g== sha1-+++Sxb/nIOrb2/UWxfpk3ueU010="
  },
  "registry": "npm",
  "hash": "fbef92c5bfe720eadbdbf516c5fa64dee794d35d"
}